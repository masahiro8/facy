(function(t){function e(e){for(var r,o,c=e[0],s=e[1],h=e[2],d=0,f=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&f.push(n[o][0]),n[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);u&&u(e);while(f.length)f.shift()();return i.push.apply(i,h||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],r=!0,c=1;c<a.length;c++){var s=a[c];0!==n[s]&&(r=!1)}r&&(i.splice(e--,1),t=o(o.s=a[0]))}return t}var r={},n={app:0},i=[];function o(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=r,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(a,r,function(e){return t[e]}.bind(null,r));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var h=0;h<c.length;h++)e(c[h]);var u=s;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0e0b":function(t,e){},"20b9":function(t,e,a){"use strict";var r=a("6732"),n=a.n(r);n.a},3522:function(t,e,a){},"414d":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("Vid",{on:{ready:t.readyVideo}}),a("Overlay",{ref:"overlay",attrs:{src:t.src,rect:t.rect},on:{callbackPoints:t.getPoints}}),a("Eyes",{attrs:{src:t.src,rect:t.rect,points:t.points,left_right:"left"}}),a("Eyes",{attrs:{src:t.src,rect:t.rect,points:t.points,left_right:"right"}}),a("Shoot",{on:{shoot:t.shoot}}),t.onFlash?a("div",{attrs:{id:"white"}}):t._e()],1)},i=[],o=(a("96cf"),a("89ba")),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"videoFrame"},[a("video",{ref:"video",staticClass:"video",attrs:{id:"srcVideo",playsinline:"",muted:"",autoplay:""},domProps:{muted:!0}})])},s=[],h=(a("d3b7"),a("2ef0")),u=(a("ac1f"),a("841c"),a("1276"),function(){for(var t={},e=location.search.substring(1).split("&"),a=0;e[a];a++){var r=e[a].split("=");t[r[0]]=r[1]}return t}),d="localhost"==document.location.hostname,f=u(),l=h["has"](f,"preview"),g=l?375:window.innerWidth,p=l?812:window.innerHeight,v=(window.devicePixelRatio,d?"":"/eyetrack"),y={inputSize:128,scoreThreshold:.5},w=function(t){var e={w:t.videoWidth,h:t.videoHeight},a=p/e.h,r={w:e.w*a,h:p},n=(r.w-g)/2,i=(r.h-p)/2,o={width:r.w+"px",height:r.h+"px",left:-n+"px",top:-i+"px"},c={x:n,y:i,width:r.w,height:r.h,rate:a};return t.width=r.w,t.height=r.h,t.style.width=o.width,t.style.height=o.height,t.style.left=o.left,t.style.top=o.top,console.log("this.video_window_rate",a,"this.video_size.w",e.w,"WINDOW_WIDTH",g,"size.w",r.w,"size.w - WINDOW_WIDTH",r.w-g,"left",n),{src:t,rect:c}},m={name:"vid",data:function(){return{}},mounted:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.initCamera(this.$refs.video);case 2:e=w(this.$refs.video),this.$emit("ready",e);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{initCamera:function(t){return new Promise((function(e,a){var r=navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}});r.then((function(a){t.muted=!0,t.playsinline=!0,t.onloadedmetadata=function(t){e(!0)},t.srcObject=a})).catch((function(t){alert(t),a(!1)}))}))}}},x=m,b=(a("e536"),a("2877")),_=Object(b["a"])(x,c,s,!1,null,"166decd8",null),D=_.exports,I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("canvas",{ref:"image",staticClass:"overlay",attrs:{id:"image",width:t.canvas_rect.width+"px",height:t.canvas_rect.height+"px"}}),a("canvas",{ref:"overlay",staticClass:"overlay",class:t.showDetection?"show":"hide",attrs:{id:"overlay",width:t.canvas_rect.width+"px",height:t.canvas_rect.height+"px"}}),a("div",{staticClass:"btn"},[t._v(" visible "),a("input",{attrs:{type:"checkbox"},on:{change:t.toggle}})])])},O=[],M=(a("d81d"),a("4e82"),a("b680"),a("e25e"),function(t,e){return(t[e]+t[e+1]+t[e+2])/3}),E=function(t,e,a){t[e]=a.r,t[e+1]=a.g,t[e+2]=a.b,t[e+3]=a.a},P=function(t,e){for(var a=40,r=t.getImageData(e.x,e.y,e.width,e.height),n=t.createImageData(e.width,e.height),i=0;i<r.data.length;i+=4){var o=(r.data[i]+r.data[i+1]+r.data[i+2])/3;o=parseInt(o,10),o=o>a?255:0,n.data[i]=o,n.data[i+1]=o,n.data[i+2]=o,n.data[i+3]=r.data[i+3]}return n},k=function(t,e){for(var a=t.getImageData(e.x,e.y,e.width,e.height),r=t.createImageData(e.width,e.height),n=function(t,r){var n=H(a.data,e.width,t,r);n.sort((function(t,e){return t-e}));var i=n[Math.floor(n.length/2)];return i},i=4*e.width;i<a.data.length-4*e.width;i+=4)i%(4*e.width)===0?console.log("empty"):(r.data[i]=n(0,i),r.data[i+1]=n(1,i),r.data[i+2]=n(2,i),r.data[i+3]=a.data[i+3]);return r},C={WHITE:-1,EYE:-2,OTHER:1},R={WHITE:{r:255,g:255,b:255,a:255},EYE:{r:0,g:0,b:0,a:255},CLEAR:{r:255,g:255,b:255,a:255},RED:{r:255,g:0,b:0,a:255}},j=function(t,e){for(var a=10,r=t.getImageData(e.x,e.y,e.width,e.height),n=t.createImageData(e.width,e.height),i=function(t,r){var n=M(t,r);if(255===n)return{rewrite:C.WHITE,first:r,last:r};var i=function r(n,i,o){var c={top:n-4*e.width,bottom:n+4*e.width,left:n-4,right:n+4},s=M(t,n),h=c[o],u=i+1;return i>a?{depth:i,last:n}:255===s?{depth:i,last:n}:r(h,u,o)},o=i(r,0,"right"),c=i(r,0,"left"),s=i(r,0,"top"),h=i(r,0,"bottom");return o.depth<a&&c.depth<a&&s.depth<a&&h.depth<a?{rewrite:C.OTHER,first:r,last:o}:{rewrite:C.EYE,first:r,last:o}},o=0;o<r.data.length;o+=4){var c=i(r.data,o);c.rewrite===C.WHITE?E(n.data,o,R.WHITE):c.rewrite===C.EYE?E(n.data,o,R.EYE):E(n.data,o,R.CLEAR)}return n},T=function(t,e){for(var a=5,r=t.getImageData(e.x,e.y,e.width,e.height),n=t.createImageData(e.width,e.height),i=0;i<r.data.length;i++)n.data[i]=r.data[i];var o=function(t,e,r){var n=function r(n,i){var o=n+4*e.width,c=M(t,o),s=i+1;return i>a?{result:!1,depth:i}:255===c?{result:!0,depth:i}:r(o,s)};return n(r,0)},c=function(t,e,a,r){for(var n=0;n<=r;n++){var i=n*(4*e.width)+a;t[i]=255,t[i+1]=0,t[i+2]=255,t[i+3]=255}},s=function(t,e){for(var a=4,r=0;r<Math.floor(e.height/a);r++)for(var i=0;i<e.width;i++){var s=Math.floor(r*(4*e.width)+4*i),h=Math.floor((r-1)*(4*e.width)+4*i),u=M(t,s),d=M(t,h);if(255===d&&0===u){var f=o(t,e,s);f.result&&f.depth>1&&c(n.data,e,s,f.depth)}}};return s(r.data,e),n},$=function(t,e){var a=1.2,r=t.getImageData(e.x,e.y,e.width,e.height),n=t.createImageData(e.width,e.height),i={x:Math.floor(e.width/2),y:Math.floor(e.height/2)},o=function(t){var a=function a(r,n,i){var o=function(t){return{top:function(){return t+4*e.width},bottom:function(){return t-4*e.width}}},c=M(t,r),s=o(r)[i](),h=n+1;return 0===c||n>Math.floor(e.height/2)?n:a(s,h,i)},r=4*i.x,n=a(r,0,"top"),o=e.height*(4*e.width)+4*i.x,c=a(o,0,"bottom");return{top:n,bottom:c}},c=function(t,e,a){for(var n=0;n<e.height;n++)for(var i=0;i<e.width;i++){var o=Math.floor(n*(4*e.width)+4*i);i>=a.x&&i<=a.x+a.width&&n>=a.y&&n<=a.y+a.height?(t[o]=r.data[o],t[o+1]=r.data[o+1],t[o+2]=r.data[o+2],t[o+3]=r.data[o+3]):(t[o]=255,t[o+1]=255,t[o+2]=255,t[o+3]=255)}},s=o(r.data),h=s.top,u=s.bottom,d=(e.height,[{x:Math.floor(e.width/2)-Math.floor(e.height/2),y:h,width:e.height*a,height:e.height-u}]);return c(n.data,e,d[0]),n},S=function(t,e,a){for(var r=t.getImageData(e.x,e.y,e.width,e.height),n=t.createImageData(e.width,e.height),i=[],o=0;o<r.data.length;o+=4){var c=(.2126*r.data[o]+.7152*r.data[o+1]+.0722*r.data[o+2])/3;c=parseInt(c,a);var s=c*(a/255);c=255*s.toFixed(1),n.data[o]=c,n.data[o+1]=c,n.data[o+2]=c,n.data[o+3]=r.data[o+3],i.push(c)}return console.log("colors = ",h["max"](i),h["min"](i)),n},W=function(t,e){return Math.sqrt(Math.pow(t.r-e.r,2)+Math.pow(t.g-e.g,2)+Math.pow(t.b-e.b,2))},H=function(t,e,a,r){var n=r-4*e,i=r+4*e;return[t[n-4+a],t[n+a],t[n+4+a],t[r-4+a],t[r+a],t[r+4+a],t[i-4+a],t[i+a],t[i+4+a]]},V=function(t,e){for(var a=t.getImageData(e.x,e.y,e.width,e.height),r=t.createImageData(e.width,e.height),n=[],i={outlineColor:{r:0,g:255,b:128},colorDistance:1,hideline:30,showPoints:!0},o=0;o<e.height;o++)for(var c=0;c<e.width;c++){var s=Math.floor(o*(4*e.width)+4*c),h=Math.floor(o*(4*e.width)+4*(c+1)),u=Math.floor((o+1)*(4*e.width)+4*c),d={r:a.data[s],g:a.data[s+1],b:a.data[s+2]},f={r:a.data[h],g:a.data[h+1],b:a.data[h+2]},l={r:a.data[u],g:a.data[u+1],b:a.data[u+2]};r.data[s]=a.data[s],r.data[s+1]=a.data[s+1],r.data[s+2]=a.data[s+2],r.data[s+3]=a.data[s+3],c>=e.width-2||o>=e.height-2||c<=1||o<=1?(r.data[s]=255,r.data[s+1]=255,r.data[s+2]=255,r.data[s+3]=255):(W(d,f)>i.colorDistance||W(d,l)>i.colorDistance)&&i.showPoints&&(r.data[s]=i.outlineColor.r,r.data[s+1]=i.outlineColor.g,r.data[s+2]=i.outlineColor.b,n.push({x:c+1,y:o+1}))}var g=function(){return r},p=function(){return n};return{getContext:g,getPoints:p}},B=(a("0e0b"),function(t,e){var a=.05,r=.07,n=function(a){return h["map"](e,(function(e){return{index:e,point:t[e]}}))},i=function(n){var i=h["map"](e,(function(e){return{index:e,point:t[e]}})),o={x:h["minBy"](i,(function(t){return t.point.x})).point.x+-a,y:h["minBy"](i,(function(t){return t.point.y})).point.y*(1-r),x2:h["maxBy"](i,(function(t){return t.point.x})).point.x+a,y2:h["maxBy"](i,(function(t){return t.point.y})).point.y*(1+r)};return o};return{get2Points:i,getPartsPoints:n}}),F=[42,43,44,45,46,47],N=[36,37,38,39,40,41],L={BW:{key:"bw",id:"ctrBW"},GRAY:{key:"gray",id:"ctrGray"},COL2:{key:"col2",id:"ctrCol2"},MEDI:{key:"median",id:"ctrMedian"},CENT:{key:"center",id:"ctrCenter"},VERT:{key:"vertical",id:"ctrVert"},HORI:{key:"horizontal",id:"ctrHori"},LINE:{key:"line",id:"ctrLine"},POIN:{key:"point",id:"ctrPoint"}},z=function(){var t={bw:!0,gray:!1,col2:!1,median:!1,center:!0,vertical:!1,horizonta:!1,line:!1,point:!1},e=[],a=function(t){e.push(t)},r=function(a,r){t[a]=r,h["map"](e,(function(e){e(t)}))},n=function(e){return t[e]};return{setCallback:a,setEffect:r,getValue:n}},q=z(),J=function(t,e,a){if(q.getValue(L.GRAY.key)){console.log("effect:gray");var r=S(t,e,10),n=S(t,a,10);t.putImageData(r,e.x,e.y),t.putImageData(n,a.x,a.y)}if(q.getValue(L.BW.key)){console.log("effect:bw");var i=P(t,e),o=P(t,a);t.putImageData(i,e.x,e.y),t.putImageData(o,a.x,a.y)}if(q.getValue(L.CENT.key)){console.log("effect:center");var c=$(t,e),s=$(t,a);t.putImageData(c,e.x,e.y),t.putImageData(s,a.x,a.y)}if(q.getValue(L.MEDI.key)){console.log("effect:median");var u=k(t,e),d=k(t,a);t.putImageData(u,e.x,e.y),t.putImageData(d,a.x,a.y),u=k(t,e),d=k(t,a),t.putImageData(u,e.x,e.y),t.putImageData(d,a.x,a.y)}if(q.getValue(L.VERT.key)){console.log("effect:vertical");var f=T(t,e),l=T(t,a);t.putImageData(f,e.x,e.y),t.putImageData(l,a.x,a.y)}if(q.getValue(L.HORI.key)){console.log("effect:horizontal");var g=j(t,e),p=j(t,a);t.putImageData(g,e.x,e.y),t.putImageData(p,a.x,a.y)}var v=function(){var r=function(t,e){return h["map"](t,(function(t){return{x:t.x+e.x,y:t.y+e.y}}))},n=V(t,e),i=V(t,a),o=n.getPoints(),c=i.getPoints();if(q.getValue(L.LINE.key)){var s=n.getContext(),u=i.getContext();t.putImageData(s,e.x,e.y),t.putImageData(u,a.x,a.y)}return{left:r(o,e),right:r(c,a)}};return{getPoints:v}},Y=function(){var t=null,e=null,a=null,r={},n={},i={},c=function(r,n){return e=n,t=r,new Promise(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,faceapi.loadTinyFaceDetectorModel("".concat(v,"/js/tiny_face_detector_model-weights_manifest.json"));case 2:return t.next=4,faceapi.loadFaceLandmarkTinyModel("".concat(v,"/js/face_landmark_68_tiny_model-weights_manifest.json"));case 4:a=new faceapi.TinyFaceDetectorOptions(y),e();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},s=function(t,e,a){var r=t instanceof HTMLVideoElement?faceapi.getMediaDimensions(t):t,n=r.width,i=r.height;return e.width=n,e.height=i,faceapi.resizeResults(a,{width:n,height:i})},h=function(t,e,a){var r=s(t,e,a),o=r.map((function(t){return t.landmarks})),c={lineWidth:2,drawLines:!0,color:"green"};faceapi.draw.drawFaceLandmarks(e,o,c);var h=e.getBoundingClientRect();i={x:o[0].imageWidth/h.width,y:o[0].imageHeight/h.height},n=o[0].shift;var u=B(o[0].relativePositions,F).get2Points(),d=B(o[0].relativePositions,N).get2Points(),f=B(o[0].relativePositions,F).getPartsPoints(),l=B(o[0].relativePositions,N).getPartsPoints(),g={x:Math.floor(h.width*u.x*i.x+n.x),y:Math.floor(h.height*u.y*i.y+n.y),width:Math.floor(h.width*u.x2*i.x-h.width*u.x*i.x),height:Math.floor(h.height*u.y2*i.y-h.height*u.y*i.y)},p={x:Math.floor(h.width*d.x*i.x+n.x),y:Math.floor(h.height*d.y*i.y+n.y),width:Math.floor(h.width*d.x2*i.x-h.width*d.x*i.x),height:Math.floor(h.height*d.y2*i.y-h.height*d.y*i.y)};return{left_eye_rect:g,right_eye_rect:p,left_eye_points:u,right_eye_points:d,left_face_eye_points:f,right_face_eye_points:l,rate:i,shift:n}},u=function(){return{points:r,shift:n,rate:i}},d=function(){return new Promise(function(){var n=Object(o["a"])(regeneratorRuntime.mark((function n(i){var o,c,s,u,d,f,l,g;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,faceapi.detectSingleFace(e,a).withFaceLandmarks(!0);case 2:o=n.sent,o&&(c=h(t,e,[o]),s=c.left_eye_rect,u=c.right_eye_rect,c.left_eye_points,c.right_eye_points,d=c.left_face_eye_points,f=c.right_face_eye_points,c.rate,c.shift,r={left:d,right:f},l=J(e.getContext("2d"),s,u),g=l.getPoints(),i(g));case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())};return{init:c,getFaceEyesData:u,getEyesPoints:d}},A=Y(),G={data:function(){return{showDetection:!1,canvas_rect:{}}},mounted:function(){},props:{rect:Object,src:HTMLVideoElement},methods:{toggle:function(t){this.showDetection=!this.showDetection},shoot:function(){var t={w:this.canvas_rect.width,h:this.canvas_rect.height},e={sx:this.rect.x/this.rect.rate,sy:0,sw:t.w/this.rect.rate,sh:t.h/this.rect.rate,dx:0,dy:0,dw:g,dh:p};console.log("this.rect.x",this.rect.x,"this.rect.width",this.rect.width,"rate  / ",this.rect.rate," = rects.sx",e.sx,"WINDOW_WIDTH",g,"Overlay size.w",t.w,"rects.sx",e.sx,"rects.sw",e.sw,"rects.dw",e.dw);var a=this.$refs.overlay.getContext("2d");a.clearRect(0,0,this.canvas_rect.width,this.canvas_rect.height),a.save(),a.drawImage(this.src,e.sx,e.sy,e.sw,e.sh,0,0,e.dw,e.dh),a.restore();var r=this.$refs.image.getContext("2d");r.clearRect(0,0,this.canvas_rect.width,this.canvas_rect.height),r.save(),r.drawImage(this.src,e.sx,e.sy,e.sw,e.sh,0,0,e.dw,e.dh),r.restore(),this.faceDetect()},pix:function(t){return t+"px"},faceDetect:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,A.getEyesPoints();case 2:e=t.sent,a=A.getFaceEyesData(),r=this.rect.width-2*this.rect.x,this.canvas_rect={width:r,height:this.rect.height},this.$emit("callbackPoints",e,a);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},watch:{src:{immediate:!0,handler:function(t,e){t!==e&&(this.src=t,A.init(this.$refs.image,this.$refs.overlay))}},rect:{immediate:!0,handler:function(t,e){if(t!==e&&this.$refs.overlay){var a=t.width-2*t.x;this.canvas_rect={width:a,height:t.height}}}}}},U=G,K=(a("5d94"),Object(b["a"])(U,I,O,!1,null,"480035e3",null)),Q=K.exports,X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"btn",on:{click:t.shoot}},[t._v("shoot")])},Z=[],tt={data:function(){return{}},methods:{shoot:function(){this.$emit("shoot")}}},et=tt,at=(a("a254"),Object(b["a"])(et,X,Z,!1,null,"782f7a9d",null)),rt=at.exports,nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("canvas",{ref:"canvas",staticClass:"overlay",attrs:{width:t.canvas_rect.width+"px",height:t.canvas_rect.height+"px"}})])},it=[],ot=(a("b64b"),function(t){for(var e=[],a=h["maxBy"](t,(function(t){return t.x})).x,r=h["minBy"](t,(function(t){return t.x})).x,n=h["maxBy"](t,(function(t){return t.y})).y,i=h["minBy"](t,(function(t){return t.y})).y,o=(a-r)/2,c=0;c<t.length;c++)for(var s=t[c].x,u=t[c].y,d=function(t,e,a,r){return Math.sqrt((t-a)*(t-a)+(e-r)*(e-r))},f=i;f<n;f++)for(var l=r;l<a;l++){var g=d(s,u,l,f);g>=.8*o&&g<1.2*o&&e.push({p:l,q:f,r:g})}for(var p={},v=0;v<e.length;v++){var y=JSON.stringify(e[v]);p[y]=p[y]?p[y]+1:1}for(var w=h["invert"](p),m=[],x=Object.keys(w).length;x>Object.keys(w).length-3;x--){var b=JSON.parse(w[x]);m.push(b)}var _={p:h["sumBy"](m,"p")/m.length,q:h["sumBy"](m,"q")/m.length,r:h["sumBy"](m,"r")/m.length};return _}),ct=(a("cb29"),function(t,e,a,r){var n=t.getBoundingClientRect(),i=t.getContext("2d");i.strokeStyle="red",i.save(),i.beginPath();for(var o=0;o<e.length;o++)0==o?i.moveTo(Math.floor(e[0].point.x*n.width*r.x+a.x),Math.floor(e[0].point.y*n.height*r.y+a.y)):i.lineTo(Math.floor(e[o].point.x*n.width*r.x+a.x),Math.floor(e[o].point.y*n.height*r.y+a.y));i.closePath(),i.clip()}),st=1,ht=function(t,e){t.getBoundingClientRect();var a=t.getContext("2d"),r=a.createRadialGradient(e.p,e.q,5,e.p,e.q,e.r);r.addColorStop(0,"rgba(13,13,13,1)"),r.addColorStop(.5,"rgba(242,172,87,1)"),r.addColorStop(1,"rgba(115, 83, 44, 1)"),a.fillStyle=r,a.beginPath(),a.arc(e.p,e.q,e.r*st,0,2*Math.PI),a.fill(),a.restore()},ut=function(t){var e=t.getBoundingClientRect(),a=t.getContext("2d");a.clearRect(0,0,e.width,e.height)},dt={data:function(){return{canvas_rect:{}}},props:{rect:Object,src:HTMLVideoElement,points:Object,left_right:String},watch:{rect:{immediate:!0,deep:!0,handler:function(t,e){if(JSON.stringify(t)!==JSON.stringify(e)&&this.$refs.canvas){var a=t.width-2*t.x;this.canvas_rect={width:a,height:t.height}}}},points:{immediate:!0,deep:!0,handler:function(t,e){if(JSON.stringify(t)!==JSON.stringify(e)&&Object.keys(t).length>0){var a=this.left_right;console.log("Eyes shift rate",t.shift.x,t.rate.x);var r=ot(t.eyes.left),n=ot(t.eyes.right),i=t.shift,o=t.rate;ut(this.$refs.canvas),r.r>n.r?n.r=r.r:n.r>r.r&&(r.r=n.r),"left"==a&&(ct(this.$refs.canvas,t.face.left,i,o),ht(this.$refs.canvas,r)),"right"==a&&(ct(this.$refs.canvas,t.face.right,i,o),ht(this.$refs.canvas,n))}}}}},ft=dt,lt=(a("20b9"),Object(b["a"])(ft,nt,it,!1,null,"76b40b74",null)),gt=lt.exports,pt=function(t){return new Promise((function(e){setTimeout((function(){e()}),t)}))},vt={name:"app",data:function(){return{src:null,rect:{},points:{},onFlash:!1}},components:{Vid:D,Shoot:rt,Overlay:Q,Eyes:gt},mounted:function(){},methods:{readyVideo:function(t){this.rect=t.rect,this.src=t.src},shoot:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.onFlash=!0,t.next=3,pt(100);case 3:return this.$refs.overlay.shoot(),t.next=6,pt(300);case 6:this.onFlash=!1;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getPoints:function(t,e){this.points={eyes:t,face:e.points,shift:e.shift,rate:e.rate}}}},yt=vt,wt=(a("5c0b"),Object(b["a"])(yt,n,i,!1,null,null,null)),mt=wt.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(mt)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";var r=a("9c0c"),n=a.n(r);n.a},"5d94":function(t,e,a){"use strict";var r=a("3522"),n=a.n(r);n.a},6732:function(t,e,a){},"7a5a":function(t,e,a){},"9c0c":function(t,e,a){},a254:function(t,e,a){"use strict";var r=a("414d"),n=a.n(r);n.a},e536:function(t,e,a){"use strict";var r=a("7a5a"),n=a.n(r);n.a}});
//# sourceMappingURL=app.8fcf7217.js.map